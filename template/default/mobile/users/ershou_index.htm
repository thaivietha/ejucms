<!DOCTYPE html>
<html lang="zh-CN">
{include file="users/header" /}
<body style="padding-top:2.625rem ;">

{include file="users/rightNav" /}

<!--列表操作-->
<div class="operate layui-form">
    <div class="operate_l">
        <input type="checkbox" lay-filter="checkAll" class="checkAll"  lay-skin="primary"  />
    </div>
    <div class="operate_r">
        <a href="javascript:;" onclick="batch_del(this,'ids');" data-url="{:url('Archives/del',['tid'=>$type_info['id']])}" data-deltype="pseudo0">批量删除</a>
        <a href="javascript:;" onclick="batch_stick(this,'ids');" data-url="{:url('Archives/stick',['type'=>'2','tid'=>$type_info['id']])}" >批量置顶</a>
    </div>
</div>
<!--列表-->
<div class="fang_list  layui-form">
    {empty name="list"}
        没有符合条件的数据
    {else /}
    {foreach name="list" item="vo" key="k" }
    <div class="fang_item">
        <div class="fang_t">
            <div class="fang_t_l">
                <input type="checkbox" name="ids[]" value="{$vo.aid}" lay-filter="ids" lay-skin="primary"/>
            </div>
            <div class="fang_t_r">
                {$vo.add_time|date="Y-m-d H:i:s",###}
            </div>
        </div>
        <div class="fang_c">
            <div class="fang_c_l">
                <img src="{$vo.litpic}" >
            </div>
            <div class="fang_c_c">
                <span>{$vo.title}</span>
                <span>{$vo.xiaoqu_name}</span>
                <span>{$vo.area}㎡</span>
            </div>
            <div class="fang_c_r">
                ￥{$vo.total_price}万
            </div>
        </div>
        <div class="fang_b">
            <div class="fang_b_l orange">
                {eq name="$vo.status" value="1"}发布{else /}待审{/eq}
            </div>
            <div class="fang_b_r">
                <a onclick="stickfun(this)" data-url="{:url('Archives/stick',['type'=>'2','tid'=>$type_info['id']])}" data-id="{$vo.aid}">置顶</a>
                <a href="{:url($table.'/edit',array('id'=>$vo['aid'],'typeid'=>$vo['typeid']))}" >编辑</a>
                <!--<a data-url="{:url($table.'/edit',array('id'=>$vo['aid'],'typeid'=>$vo['typeid']))}" class="customvar_edit" >编辑</a>-->
                <a href="{$vo.arcurl}">浏览</a>
                <a onclick="delfun(this)" data-url="{:url('Archives/del',['tid'=>$type_info['id']])}" data-id="{$vo.aid}" data-deltype="pseudo0">删除</a>
            </div>
        </div>
    </div>
    {/foreach}
    {/empty}
    {$page}
</div>
<script>
    layui.config({
        base: '__SKIN__/' //静态资源所在路径
        ,version: '{$version}'
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'table', 'element'], function() {
        var $ = layui.$,
            form = layui.form,
            layer = layui.layer,
            element = layui.element,
            table = layui.table;

        // 监听复选框全选
        form.on('checkbox(checkAll)', function(data){
            console.log(data.elem.checked);
            if (data.elem.checked) {
                $('.checkAll').attr('checked', true);
                $('input[name*=ids]').attr('checked', true);
            } else {
                $('.checkAll').attr('checked', false);
                $('input[name*=ids]').attr('checked', false);
            }
            form.render('checkbox');
        });

        // 监听每行复选框
        form.on('checkbox(ids)', function(data){
            console.log(data.elem.checked);
            if (data.elem.checked && $('input[name*=ids]:checked').length == $('input[name*=ids]').length) {
                $('.checkAll').attr('checked', true);
            } else {
                $('.checkAll').attr('checked', false);
            }
            form.render('checkbox');
        });
    });

    //新增
    $('#customvar_add').click(function (){
        var iframes = layer.open({
            type: 2,
            title: false,
            closeBtn: false,
            fixed: true, //不固定
            shadeClose: false,
            shade: 0.3,
            content: $(this).attr('data-url')
        });
        layer.full(iframes);
    });
    //编辑
    $('.customvar_edit').click(function () {
        var iframes = layer.open({
            type: 2,
            title: false,
            closeBtn: false,
            fixed: true, //不固定
            shadeClose: false,
            shade: 0.3,
            content: $(this).attr('data-url')
        });
        layer.full(iframes);
    });
    //置顶
    $('.customvar_stick').click(function () {
        var iframes = layer.open({
            type: 2,
            title: "置顶",
            fixed: true, //不固定
            shadeClose: false,
            shade: 0.3,
            maxmin: false, //开启最大化最小化按钮
            area: ['450px', '330px'],
            content: $(this).attr('data-url')
        });
    });

</script>



<script type="text/javascript">
    //顶部右侧导航按钮
    $(".menuBox .icon-gengduo").on("click",function(){
        $(".rightNav").show();
        $(".menuBox .icon-gengduo").hide();
        $(".menuBox .icon-guanbi").show();
        $(".zhezhao").show();
    })
    $(".menuBox .icon-guanbi").on("click",function(){
        $(".rightNav").hide();
        $(".menuBox .icon-gengduo").show();
        $(".menuBox .icon-guanbi").hide();
        $(".zhezhao").hide();
    })
</script>

</body>
</html>
